{"ast":null,"code":"import _asyncToGenerator from \"/Users/kirian/Documents/GitHub/polygogo_front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { CookieService } from 'ngx-cookie-service';\nimport { User } from '../login/user';\nimport { Game } from './game';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"ngx-cookie-service\";\nimport * as i3 from \"./game.service\";\nimport * as i4 from \"../logOut/logOut.component\";\nexport class GameComponent {\n  constructor(router, cookieService, gameService) {\n    this.router = router;\n    this.cookieService = cookieService;\n    this.gameService = gameService;\n    this.user = new User();\n    this.game = new Game();\n  }\n\n  ngOnInit() {\n    if (!this.cookieService.get('username')) {\n      this.router.navigate(['/login']);\n    } else {\n      this.user.username = this.cookieService.get('username');\n      this.user.password = this.cookieService.get('password');\n      this.gameService.checkIfPlayerInGame(this.user).subscribe(response => {\n        if (response) {\n          this.gameService.game = response;\n\n          if (response.players_details.length < 4) {\n            this.router.navigate(['/game']);\n          } else {\n            this.router.navigate(['/board']);\n          }\n        } else {\n          this.searchGame();\n        }\n      });\n    }\n  }\n\n  searchGame() {\n    this.gameService.search(this.user).subscribe(response => {\n      this.game = response;\n      console.log(this.game.id);\n      this.waitForGame();\n    });\n  }\n\n  waitForGame() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.gameService.findById(_this.game).subscribe( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (response) {\n          _this.game = response;\n\n          if (_this.game.players_details.length < 4) {\n            console.log(\"no hay jugador 4\");\n            yield _this.delay(5000);\n\n            _this.waitForGame();\n          } else {\n            console.log(\"entrando en partida\");\n\n            _this.router.navigate(['/board']);\n          }\n        });\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  delay(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n\n}\n\nGameComponent.ɵfac = function GameComponent_Factory(t) {\n  return new (t || GameComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.CookieService), i0.ɵɵdirectiveInject(i3.GameService));\n};\n\nGameComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: GameComponent,\n  selectors: [[\"app-game\"]],\n  features: [i0.ɵɵProvidersFeature([CookieService])],\n  decls: 7,\n  vars: 1,\n  consts: [[1, \"d-flex\", \"align-items-center\"], [\"role\", \"status\", \"aria-hidden\", \"true\", 1, \"spinner-border\", \"ml-auto\"]],\n  template: function GameComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"app-logOut\");\n      i0.ɵɵelementStart(1, \"p\");\n      i0.ɵɵtext(2);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"div\", 0);\n      i0.ɵɵelementStart(4, \"strong\");\n      i0.ɵɵtext(5, \"Loading...\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(6, \"div\", 1);\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\" \", ctx.user.username, \"\\n\");\n    }\n  },\n  directives: [i4.LogOutComponent],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJnYW1lLmNvbXBvbmVudC5zYXNzIn0= */\"]\n});","map":{"version":3,"sources":["/Users/kirian/Documents/GitHub/polygogo_front/src/app/game/game.component.ts"],"names":["CookieService","User","Game","i0","i1","i2","i3","i4","GameComponent","constructor","router","cookieService","gameService","user","game","ngOnInit","get","navigate","username","password","checkIfPlayerInGame","subscribe","response","players_details","length","searchGame","search","console","log","id","waitForGame","findById","delay","ms","Promise","resolve","setTimeout","ɵfac","GameComponent_Factory","t","ɵɵdirectiveInject","Router","GameService","ɵcmp","ɵɵdefineComponent","type","selectors","features","ɵɵProvidersFeature","decls","vars","consts","template","GameComponent_Template","rf","ctx","ɵɵelement","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate1","directives","LogOutComponent","styles"],"mappings":"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","sourcesContent":["import { CookieService } from 'ngx-cookie-service';\nimport { User } from '../login/user';\nimport { Game } from './game';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"ngx-cookie-service\";\nimport * as i3 from \"./game.service\";\nimport * as i4 from \"../logOut/logOut.component\";\nexport class GameComponent {\n    constructor(router, cookieService, gameService) {\n        this.router = router;\n        this.cookieService = cookieService;\n        this.gameService = gameService;\n        this.user = new User();\n        this.game = new Game();\n    }\n    ngOnInit() {\n        if (!this.cookieService.get('username')) {\n            this.router.navigate(['/login']);\n        }\n        else {\n            this.user.username = this.cookieService.get('username');\n            this.user.password = this.cookieService.get('password');\n            this.gameService.checkIfPlayerInGame(this.user).subscribe(response => {\n                if (response) {\n                    this.gameService.game = response;\n                    if (response.players_details.length < 4) {\n                        this.router.navigate(['/game']);\n                    }\n                    else {\n                        this.router.navigate(['/board']);\n                    }\n                }\n                else {\n                    this.searchGame();\n                }\n            });\n        }\n    }\n    searchGame() {\n        this.gameService.search(this.user).subscribe(response => {\n            this.game = response;\n            console.log(this.game.id);\n            this.waitForGame();\n        });\n    }\n    async waitForGame() {\n        this.gameService.findById(this.game).subscribe(async (response) => {\n            this.game = response;\n            if (this.game.players_details.length < 4) {\n                console.log(\"no hay jugador 4\");\n                await this.delay(5000);\n                this.waitForGame();\n            }\n            else {\n                console.log(\"entrando en partida\");\n                this.router.navigate(['/board']);\n            }\n        });\n    }\n    delay(ms) {\n        return new Promise(resolve => setTimeout(resolve, ms));\n    }\n}\nGameComponent.ɵfac = function GameComponent_Factory(t) { return new (t || GameComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.CookieService), i0.ɵɵdirectiveInject(i3.GameService)); };\nGameComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: GameComponent, selectors: [[\"app-game\"]], features: [i0.ɵɵProvidersFeature([CookieService])], decls: 7, vars: 1, consts: [[1, \"d-flex\", \"align-items-center\"], [\"role\", \"status\", \"aria-hidden\", \"true\", 1, \"spinner-border\", \"ml-auto\"]], template: function GameComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵelement(0, \"app-logOut\");\n        i0.ɵɵelementStart(1, \"p\");\n        i0.ɵɵtext(2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 0);\n        i0.ɵɵelementStart(4, \"strong\");\n        i0.ɵɵtext(5, \"Loading...\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(6, \"div\", 1);\n        i0.ɵɵelementEnd();\n    } if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\" \", ctx.user.username, \"\\n\");\n    } }, directives: [i4.LogOutComponent], styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJnYW1lLmNvbXBvbmVudC5zYXNzIn0= */\"] });\n"]},"metadata":{},"sourceType":"module"}